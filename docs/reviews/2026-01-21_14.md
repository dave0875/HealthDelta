# Review: Issue #14 — Operator integration for Doctor’s Note + ADR

Reviewed with: `ollama/llama3.1:8b`

Issue: https://github.com/dave0875/HealthDelta/issues/14

## Summary
- Integrates Doctor’s Note generation (Issue #13) into the operator command (Issue #12) via direct function call.
- Writes deterministic note outputs to `<base_out>/<run_id>/note/doctor_note.{txt,md}` and records pointers in the run registry.
- Adds `--skip-note` to explicitly disable note generation.
- Adds ADR documenting why Doctor’s Note remains a reusable subcommand while also being generated by the operator path.
- Extends synthetic integration test coverage for note file creation, determinism across no-op reruns, banned-token absence, and registry pointers.

## Risks / Gaps
- [severity: low] Older runs created before Issue #14 may not have note pointers in `runs.json`; operator no-op output uses deterministic paths and should not attempt backfill during no-op.
- [severity: low] Local environments without `duckdb` will skip operator/note integration tests; CI remains authoritative proof.

## Determinism + privacy checks
- No-op runs do not regenerate note outputs or mutate registry files (asserted by byte comparisons in tests).
- Note outputs remain share-safe (aggregate-only; no names/DOB/free-text identifiers) and are checked for banned tokens in tests.
- Registry pointers are relative paths under `<base_out>`; no absolute input paths are stored.

## CI / artifacts checklist
- Confirm CI green for Issue #14 commits:
  - Linux job runs tests including updated `tests/test_operator.py`.
  - macOS self-hosted job uploads `.xcresult` (`ios-xcresult`) artifact.
- Post CI run URL and artifact confirmation on Issue #14, and add a clarifying comment on Issue #12 pointing to Issues #13 and #14.


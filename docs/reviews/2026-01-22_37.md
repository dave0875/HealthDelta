# Review â€” Issue 37 (2026-01-22)

Issue: https://github.com/dave0875/HealthDelta/issues/37

Reviewer model
- `ollama/llama3.1:8b` (invoked locally on GORF)

Change summary
- Added `healthdelta ingest ios` routing in `healthdelta/cli.py` without breaking the existing `healthdelta ingest` behavior.
- Implemented `ingest_ios_to_staging` in `healthdelta/ingest.py`:
  - validates expected iOS run directory inputs
  - computes deterministic run_id from content hashes
  - copies inputs into a stable staging layout
  - writes a deterministic, share-safe staging `manifest.json` (no absolute paths or timestamps)
- Added synthetic tests in `tests/test_ingest_ios.py` proving deterministic manifest output across reruns.

Findings
- Acceptance criteria: Met (CLI added; validation + deterministic staging layout + manifest; synthetic tests present; CI required before closure).
- Determinism: run_id derived from stable relpaths + sha256(bytes); manifest JSON uses sorted keys and contains no time-varying fields.
- Privacy: manifest avoids absolute paths and does not include payload snippets; copied iOS manifest is staged under `source/ios/` (operators should treat staging as sensitive unless later de-identified).

Risks / edge cases
- Current validation assumes the iOS export directory includes `ndjson/observations.ndjson` and `manifest.json`; if the iOS layout evolves, update the allowlist and tests.


# Review â€” Issue 27 (2026-01-22)

Issue: https://github.com/dave0875/HealthDelta/issues/27

Reviewer model
- `ollama/llama3.1:8b` (invoked locally on GORF)

Change summary
- Share bundles now include `registry/bundle_manifest.csv` (path/size/sha256) for all archived files (excluding the manifest itself).
- New `healthdelta share verify` enforces allowlist-only members, validates `registry/run_entry.json` JSON parsing, and checks manifest size/hash for each file.

Findings
- Correctness: Verification is implemented as deterministic checks returning a sorted error list; CLI prints stable `ERROR ...` lines and a count.
- Security: Verifier rejects unsafe member names (absolute paths, `..` segments) and disallowed top-level subtrees; it does not extract files to disk.
- Privacy: Verifier output uses archive member paths only (no absolute local paths), and it avoids emitting file contents.
- Determinism: Bundle manifest and verifier output are path-sorted and stable across reruns for unchanged inputs.

Risks / edge cases
- Manifest is not cryptographically signed; a malicious actor could tamper with both payload and manifest. This verifier is intended to prevent accidental mistakes, not provide adversarial integrity.
- Some tar archives may include unusual member types (symlinks, device nodes); verifier reports these as unsupported.

Follow-ups (not in scope)
- Consider optional detached signature / external hash file for stronger adversarial integrity.
- Consider adding a hash-mismatch negative test for additional coverage.


# Review: Issue #17 â€” Export Layout Resolver

Reviewed with: `ollama/llama3.1:8b`

Issue: https://github.com/dave0875/HealthDelta/issues/17

## Summary
- Adds `healthdelta/export_layout.py` to deterministically resolve the canonical export root and share-safe relative paths for `export.xml`, optional `export_cda.xml`, and optional clinical JSON directory.
- Updates `healthdelta export profile` to use the resolver so profiling stays scoped to the canonical export subtree and avoids scanning unrelated files in wrapper directories.
- Adds synthetic fixtures and tests verifying wrapped-layout support, exclusion of unrelated files, deterministic output bytes, and absence of banned tokens.

## Risks / Gaps
- [severity: low] Resolver candidate set is intentionally small (direct root or `apple_health_export/`). New variants should be introduced via new issues rather than expanding heuristics silently.
- [severity: low] Clinical directory candidates are limited; if real exports use a different clinical path, follow-up issues should add explicit candidates with tests.

## Determinism + privacy checks
- Resolver returns only relative paths (no absolute path leakage).
- Profile outputs remain share-safe: no payload fragments; tests include banned tokens in fixture content and assert they are not emitted.

## CI / artifacts checklist
- Confirm CI green:
  - Linux tests job
  - macOS Xcode job with `ios-xcresult` artifact
- Post Actions run URL on Issue #17 and close the issue after verification.


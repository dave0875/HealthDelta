# Review â€” Issue 38 (2026-01-22)

Issue: https://github.com/dave0875/HealthDelta/issues/38

Reviewer model
- `ollama/llama3.1:8b` (invoked locally on GORF)

Change summary
- Added iOS input detection for `duckdb build` (iOS run dir contains `manifest.json` + `ndjson/observations.ndjson`).
- Implemented subset field mapping for iOS observation rows into the existing `observations` DuckDB table (event_time from start_time, hk_type from sample_type, run_id from manifest).
- Relaxed required streams only for detected iOS inputs.
- Added synthetic tests for iOS ingestion and rerun dedupe; documented mapping in `docs/runbook_duckdb.md`.

Findings
- Acceptance criteria: Met (loader accepts iOS inputs; tests added; mapping documented; CI required before closing).
- Determinism: Uses existing record_key-based dedupe and deterministic parsing; iOS run_id sourced from input manifest; no new time-varying fields introduced.
- Privacy: No new PII fields; iOS inputs are treated as local artifacts and not exfiltrated.

Risks / edge cases
- Detection is heuristic (manifest.json + ndjson/observations.ndjson). If other inputs match accidentally, behavior changes (mitigated by requiring ndjson/observations.ndjson).
- iOS schema will evolve (additional streams/fields). Update mapping/tests as new iOS exporters ship.

